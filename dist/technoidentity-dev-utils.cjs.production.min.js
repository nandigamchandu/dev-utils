"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var n=e(require("chance")),r=require("technoidentity-utils"),t=require("tcomb"),i=e(t),a=require("json-server");function o(){return(o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e}).apply(this,arguments)}var u=new n,c={integer:{min:100,max:1e3},floating:{min:0,max:100,fixed:2},sentence:{words:4},array:{minLength:0,maxLength:6}};function f(e,n){var t=u.integer({min:n.array.minLength,max:n.array.maxLength});return r.repeatedly(t,function(){return s(e,n)})}function s(e,n){if(void 0===n&&(n=c),"Int"===e.name)return u.integer(n.integer);if(e instanceof r.NumberType)return u.floating(n.floating);if(e instanceof r.StringType)return u.sentence(n.sentence);if(e instanceof r.BooleanType)return u.bool();if("Date"===e.name)return u.date();if("DateFromISOString"===e.name)return u.date();if(e instanceof r.KeyofType)return u.pickone(Object.keys(e.keys));if(e instanceof r.EnumType)return u.pickone(e.keys);if(e instanceof r.LiteralType)return e.value;if(e instanceof r.NullType)return null;if(!(e instanceof r.UndefinedType||e instanceof r.VoidType)){if(e instanceof r.ReadonlyType||e instanceof r.ExactType||e instanceof r.RefinementType)return s(e.type,n);if(e instanceof r.ReadonlyArrayType)return f(e.type,n);if(e instanceof r.AnyArrayType)return f(r.unknown,n);if(e instanceof r.ArrayType)return function(e,n){return f(e.type,n)}(e,n);if(e instanceof r.InterfaceType||e instanceof r.PartialType||e instanceof r.ObjType)return r.buildObject(e.props,function(e){return s(e,n)});if(e instanceof r.IntersectionType)return e.types.map(function(e){return s(e,n)}).reduce(function(e,n){return o({},e,{},n)});if(e instanceof r.UnionType){var t=u.integer({min:0,max:e.types.length-1});return s(e.types[t],n)}if(e instanceof r.TupleType)return e.types.map(function(e){return s(e,n)});throw console.log("hello"),new Error("Unsupported type: "+e.name)}}var p=new n,y=[i.Number,i.String,i.Boolean,i.Date,i.Nil];exports.defaultOptions=c,exports.fake=s,exports.fakeFromRT=function e(n,i){if(void 0===i&&(i=c),!r.isType(n))throw console.log(n.name),new Error("I have no idea about what do with a function");if(r.verify(n&&n.meta&&n.meta.kind),r.isInteger(n))return p.integer(i.integer);if(r.isStruct(n))return n(r.buildObject(n.meta.props,function(n){return e(n,i)}));if(r.isInterface(n))return r.buildObject(n.meta.props,function(n){return e(n,i)});if(r.isList(n)){var a=p.integer({min:i.array.minLength,max:i.array.maxLength});return r.repeatedly(a,function(){return e(n.meta.type,i)})}if(r.isDict(n))return{};if(r.isIntersection(n))return n.meta.types.map(function(n){return e(n,i)}).reduce(function(e,n){return o({},e,{},n)});if(r.isMaybe(n))return p.pickone([e(n.meta.type),void 0]);if(r.isUnion(n))return p.pickone(n.meta.types.map(function(n){return e(n,i)}));if(r.isEnums(n))return p.pickone(Object.keys(n.meta.map));if(r.isTuple(n))return n.meta.types.map(function(n){return e(n,i)});if(r.isIrreducible(n))return function(n,i){switch(r.verify("irreducible"===n.meta.kind,"rt must be irreducible"),n.meta.name){case"Number":return p.floating(i.floating);case"Any":return e(p.pickone(y));case"String":return p.sentence(i.sentence);case"Boolean":return p.bool();case"Date":return p.date();case"Function":return function(){return e(t.Any,i)};case"Nil":return p.pickone([void 0,null]);case"Error":return new Error("fake error");case"Object":var a=p.integer({min:4,max:8});return r.repeatedly(a,function(){return[p.word({length:p.integer({min:4,max:8})}),e(p.pickone(y),i)]}).reduce(function(e,n){var r;return o({},e,((r={})[n[0]]=n[1],r))});case"Array":var u=p.integer({min:i.array.minLength,max:i.array.maxLength});return r.repeatedly(u,function(){return e(p.pickone(y),i)});default:throw new Error("Unsupported tcomb type: "+n.meta.kind+": "+n.meta.name)}}(n,i);throw new Error("Unsupported tcomb type: "+n.meta.kind)},exports.startFakeJSONServer=function(e,n){void 0===n&&(n=process.env.PORT||5555),a.create().use(a.defaults()).use(a.router(function(e){var n={},t=function(){if(a){if(o>=i.length)return"break";u=i[o++]}else{if((o=i.next()).done)return"break";u=o.value}var e=u.spec;n[u.name]=r.range(u.count).map(function(n){return s(e)})},i=e,a=Array.isArray(i),o=0;for(i=a?i:i[Symbol.iterator]();;){var u;if("break"===t())break}return n}(e))).listen(n,function(){console.log("fake JSON Server is running at port: "+n)})};
//# sourceMappingURL=technoidentity-dev-utils.cjs.production.min.js.map
